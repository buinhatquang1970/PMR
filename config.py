# config.py
# CẤU HÌNH HỆ THỐNG TÍNH TOÁN TẦN SỐ PMR
# Phiên bản: Final Fix (Tách biệt hoàn toàn chỉ tiêu VHF và UHF theo Rev9_Sep2017)

# =============================================================================
# A. CẤU HÌNH GIAO DIỆN & MÀU SẮC
# =============================================================================
PRIORITY_HIGHLIGHT_COLOR = '#F6BE00' 

# =============================================================================
# B. QUY HOẠCH TẦN SỐ (THEO REV 9)
# =============================================================================

# --- BẢNG 1: VHF ---
FREQUENCY_ALLOCATION_VHF = [
    (138.0000, 141.5000, ['LAN'], "LAN"),
    (141.5000, 142.0000, ['WAN_SIMPLEX'], "WAN Simplex"),
    (146.0000, 146.5000, ['LAN'], "LAN"),
    (146.5000, 147.0000, ['WAN_SIMPLEX'], "WAN Simplex"),
    (147.0000, 149.0000, ['WAN_DUPLEX'], "WAN Duplex"),
    (149.0000, 149.4000, ['LAN', 'WAN_SIMPLEX'], "LAN, WAN Simplex"),
    (149.4000, 149.9000, ['LAN', 'WAN_SIMPLEX'], "LAN, WAN Simplex"),
    (150.0500, 151.4375, ['WAN_DUPLEX'], "WAN Duplex"),
    (152.4375, 153.0000, ['WAN_SIMPLEX'], "WAN Simplex"),
    (153.0000, 154.0000, ['LAN'], "LAN"),
    (154.0000, 154.9000, ['WAN_DUPLEX'], "WAN Duplex"),
    (154.9000, 155.0500, ['WAN_SIMPLEX'], "WAN Simplex"),
    (155.0500, 155.6000, ['LAN'], "LAN"),
    (155.6000, 156.0125, ['WAN_SIMPLEX', 'WAN_DUPLEX'], "WAN Simplex/Duplex"),
    (156.0125, 156.4375, ['WAN_SIMPLEX'], "WAN Simplex"),
    
    # VTN 5B - Hàng hải (Ưu tiên)
    (156.4375, 156.4875, ['LAN'], "LAN (Hàng hải ưu tiên)"),
    (156.5625, 156.7625, ['LAN'], "LAN (Hàng hải ưu tiên)"),
    (156.8375, 157.4375, ['LAN', 'WAN_SIMPLEX'], "LAN, WAN Simplex (Hàng hải ưu tiên)"),
    
    (160.4375, 160.6000, ['LAN'], "LAN"),
    (160.6000, 160.9750, ['LAN'], "LAN (Hàng hải ưu tiên)"),
    (160.9750, 161.4750, ['LAN'], "LAN"),
    (161.4750, 161.5250, ['LAN'], "LAN (Hàng hải ưu tiên)"),
    (161.5250, 161.9625, ['LAN', 'WAN_SIMPLEX'], "LAN, WAN Simplex (Hàng hải ưu tiên)"),
    
    (161.9875, 162.0125, ['LAN'], "LAN (Hàng hải ưu tiên)"),
    (162.0375, 162.0500, ['WAN_DUPLEX'], "WAN Duplex (Hàng hải ưu tiên)"),
    
    (162.0500, 165.0000, ['WAN_DUPLEX'], "WAN Duplex"),
    (165.0000, 166.0000, ['LAN', 'WAN_DUPLEX'], "LAN, WAN Duplex"),
    (166.0000, 167.0000, ['WAN_SIMPLEX'], "WAN Simplex"),
    (167.0000, 170.0000, ['WAN_DUPLEX'], "WAN Duplex"),
    (170.0000, 171.0000, ['LAN', 'WAN_SIMPLEX'], "LAN, WAN Simplex"),
    (171.0000, 174.0000, ['LAN'], "LAN"),
]

# --- BẢNG 2: UHF ---
FREQUENCY_ALLOCATION_UHF = [
    (406.2000, 409.0000, ['LAN'], "LAN"),
    (409.0000, 410.0000, ['WAN_SIMPLEX'], "WAN Simplex"),
    (415.0000, 415.5000, ['LAN'], "LAN"),
    (415.5000, 418.5000, ['LAN', 'WAN_DUPLEX'], "LAN, WAN Duplex"),
    (418.5000, 419.5000, ['LAN', 'WAN_DUPLEX'], "WAN Duplex, LAN (Note b: HCM/DN)"),
    (419.5000, 420.0000, ['WAN_SIMPLEX'], "WAN Simplex"),
    (425.0000, 425.5000, ['WAN_SIMPLEX'], "WAN Simplex"),
    (425.5000, 428.5000, ['LAN', 'WAN_DUPLEX'], "LAN, WAN Duplex"),
    (428.5000, 429.5000, ['LAN', 'WAN_DUPLEX'], "WAN Duplex, LAN (Note b: HCM/DN)"),
    (429.5000, 430.0000, ['LAN'], "LAN"),
    (440.0000, 440.5000, ['LAN'], "LAN"),
    (440.5000, 441.0000, ['LAN'], "LAN (Note b: HCM)"),
    (441.0000, 441.2000, ['WAN_DUPLEX', 'WAN_SIMPLEX'], "WAN Duplex/Simplex"),
    (441.2000, 444.0000, ['WAN_DUPLEX'], "WAN Duplex"),
    (444.0000, 445.5000, ['WAN_SIMPLEX'], "WAN Simplex"),
    (445.5000, 446.0000, ['LAN', 'WAN_DUPLEX'], "WAN Duplex, LAN (Note b: HCM)"),
    (446.2000, 449.0000, ['WAN_DUPLEX'], "WAN Duplex"),
    (449.0000, 450.0000, ['LAN'], "LAN"),
    (450.0000, 450.5000, ['LAN'], "LAN"),
    (457.3700, 457.4750, ['LAN'], "LAN"),
    (461.4750, 463.0800, ['LAN'], "LAN"),
    (467.3700, 470.0000, ['LAN'], "LAN"),
]

# =============================================================================
# C. DANH SÁCH CẤM, DÙNG CHUNG, ƯU TIÊN
# =============================================================================
FORBIDDEN_BANDS = [
    (157.4375, 160.4375),
    (150.0500, 151.4375), 
    (151.4375, 152.4375), 
    (450.5000, 453.0799), 
    (453.0800, 454.5000), 
    (457.4750, 461.4750), 
    (406.1000, 406.2000),
    (408.8750, 408.9750) 
]

SHARED_FREQUENCIES = [
    138.750, 140.425, 140.750, 142.750, 147.800, 148.475, 147.575, 148.650, 163.225, 168.225, 169.250, 169.900,
    406.325, 408.825, 408.300, 408.475, 441.475, 449.125, 449.400
]

MARITIME_PRIORITY_BANDS = [
    (156.0000, 156.4875),
    (156.5625, 156.7625),
    (156.8375, 157.4500),
    (160.6000, 160.9750),
    (161.4750, 161.9625),
    (161.9875, 162.0125),
    (162.0375, 162.0500)
]

# =============================================================================
# D. MATRIX KHOẢNG CÁCH (CẬP NHẬT CHUẨN TÀI LIỆU REV 9)
# =============================================================================

# --- D.1 MA TRẬN VHF ---
MATRIX_VHF = {
    # Bảng VHF_625_H15 (Source 69), VHF_125_H15 (Source 76), VHF_25_H15 (Source 83)
    "LAN_BIG_CITY_HIGH": {
        6.25: {0:{6.25:10,12.5:10,25:10}, 6.25:{6.25:2.1,12.5:6,25:8.5}, 12.5:{6.25:0.2,12.5:0.6,25:3.2}, 18.75:{6.25:0.1,12.5:0.3,25:0.7}},
        12.5: {0:{6.25:10,12.5:10,25:10}, 6.25:{6.25:6,12.5:7,25:8.7}, 12.5:{6.25:0.6,12.5:1.2,25:4.5}, 18.75:{6.25:0.3,12.5:0.4,25:1.1}, 25:{6.25:0,12.5:0.1,25:0.2}},
        25.0: {0:{6.25:10,12.5:10,25:10}, 6.25:{6.25:8.5,12.5:8.7,25:9}, 12.5:{6.25:3.2,12.5:4.5,25:4.9}, 18.75:{6.25:0.7,12.5:1.1,25:1.7}, 25:{6.25:0,12.5:0.2,25:0.4}, 37.25:{25:0.2}}
    },
    # Bảng VHF_625_L15 (Source 91), VHF_125_L15 (Source 98), VHF_25_L15 (Source 105)
    "LAN_BIG_CITY_LOW": {
        6.25: {0:{6.25:6.3,12.5:6.3,25:6.3}, 6.25:{6.25:1.4,12.5:4,25:5}, 12.5:{6.25:0.1,12.5:0.3,25:1.5}, 18.75:{6.25:0,12.5:0.1,25:0.2}},
        12.5: {0:{6.25:6.3,12.5:6.3,25:6.3}, 6.25:{6.25:4,12.5:5,25:5.5}, 12.5:{6.25:0.3,12.5:0.9,25:2}, 18.75:{6.25:0.1,12.5:0.2,25:0.7}, 25:{25:0.2}},
        25.0: {0:{6.25:6.3,12.5:6.3,25:6.3}, 6.25:{6.25:5,12.5:5.5,25:6}, 12.5:{6.25:1.5,12.5:2,25:3.5}, 18.75:{6.25:0.2,12.5:0.7,25:1.2}, 25:{6.25:0,12.5:0.2,25:0.3}, 37.25:{25:0.1}}
    },
    # Bảng VHF_625 (Source 113), VHF_125 (Source 120), VHF_25 (Source 127)
    "LAN_PROVINCE": {
        6.25: {0:{6.25:10,12.5:10,25:10}, 6.25:{6.25:2.1,12.5:6,25:8.7}, 12.5:{6.25:0.2,12.5:0.6,25:3.2}, 18.75:{6.25:0.3,12.5:0.2,25:0.8}},
        12.5: {0:{6.25:10,12.5:10,25:10}, 6.25:{6.25:6,12.5:7.2,25:8.7}, 12.5:{6.25:0.6,12.5:3,25:6}, 18.75:{6.25:0.2,12.5:0.2,25:1.2}, 25:{6.25:0,12.5:0.1,25:0.4}},
        25.0: {0:{6.25:10,12.5:10,25:10}, 6.25:{6.25:8.7,12.5:8.7,25:9}, 12.5:{6.25:3.2,12.5:6,25:6.5}, 18.75:{6.25:0.8,12.5:1.2,25:1.7}, 25:{6.25:0,12.5:0.4,25:0.4}, 37.25:{25:0.2}}
    },
    # Bảng VHF_625_WS (Source 136), VHF_125_WS (Source 143), VHF_25_WS (Source 150)
    "WAN_SIMPLEX": {
        6.25: {0:{6.25:140,12.5:140,25:140}, 6.25:{6.25:90,12.5:123,25:136}, 12.5:{6.25:33,12.5:51,25:106}, 18.75:{6.25:33,12.5:25,25:64}, 25:{6.25:26,12.5:20,25:21}},
        12.5: {0:{6.25:140,12.5:140,25:140}, 6.25:{6.25:130,12.5:130,25:135}, 12.5:{6.25:33,12.5:35,25:100}, 18.75:{6.25:30,12.5:22,25:76}, 25:{6.25:23,12.5:5,25:8}},
        25.0: {0:{6.25:140,12.5:140,25:140}, 6.25:{6.25:136,12.5:135,25:135}, 12.5:{6.25:106,12.5:100,25:118}, 18.75:{6.25:64,12.5:76,25:82}, 25:{6.25:21,12.5:8,25:56}}
    },
    # Bảng VHF_625_WD (Source 158), VHF_125_WD (Source 165), VHF_25_WD (Source 172)
    "WAN_DUPLEX": {
        6.25: {0:{6.25:100,12.5:100,25:100}, 6.25:{6.25:52,12.5:86,25:94}, 12.5:{6.25:0,12.5:0,25:63}},
        12.5: {0:{6.25:100,12.5:140,25:140}, 6.25:{6.25:94,12.5:87,25:94}, 12.5:{6.25:0,12.5:76,25:100}, 18.75:{6.25:0,12.5:22,25:47}, 25:{6.25:0,12.5:5,25:8}},
        25.0: {0:{6.25:100,12.5:140,25:140}, 6.25:{6.25:94,12.5:94,25:94}, 12.5:{6.25:63,12.5:100,25:74}, 18.75:{6.25:0,12.5:47,25:49}, 25:{6.25:0,12.5:8,25:43}}
    }
}

# --- D.2 MA TRẬN UHF (ĐÃ TÁCH BIỆT VỚI VHF) ---
MATRIX_UHF = {
    # Bảng UHF_625_H15 (Source 72), UHF_125_H15 (Source 79), UHF_25_H15 (Source 86)
    "LAN_BIG_CITY_HIGH": {
        6.25: {0:{6.25:10,12.5:10,25:10}, 6.25:{6.25:2.1,12.5:6,25:8.5}, 12.5:{6.25:0.2,12.5:0.6,25:3.2}, 18.75:{6.25:0.1,12.5:0.3,25:0.7}},
        12.5: {0:{6.25:10,12.5:10,25:10}, 6.25:{6.25:6,12.5:7,25:8.7}, 12.5:{6.25:0.6,12.5:1.2,25:4.5}, 18.75:{6.25:0.3,12.5:0.4,25:1.1}},
        25.0: {0:{6.25:10,12.5:10,25:10}, 6.25:{6.25:8.5,12.5:8.7,25:9}, 12.5:{6.25:3.2,12.5:4.5,25:4.9}, 18.75:{6.25:0.7,12.5:1.1,25:1.7}, 25:{6.25:0,12.5:0.2,25:0.4}, 37.25:{25:0.2}}
    },
    # Bảng UHF_625_L15 (Source 94), UHF_125_L15 (Source 101), UHF_25_L15 (Source 108)
    "LAN_BIG_CITY_LOW": {
        6.25: {0:{6.25:6.3,12.5:6.3,25:6.3}, 6.25:{6.25:1.4,12.5:4,25:5}, 12.5:{6.25:0.1,12.5:0.3,25:1.5}, 18.75:{6.25:0,12.5:0.1,25:0.2}},
        12.5: {0:{6.25:6.3,12.5:6.3,25:6.3}, 6.25:{6.25:4,12.5:5,25:5.5}, 12.5:{6.25:0.3,12.5:0.9,25:2}, 18.75:{6.25:0.1,12.5:0.2,25:0.7}, 25:{25:0.2}},
        25.0: {0:{6.25:6.3,12.5:6.3,25:6.3}, 6.25:{6.25:5,12.5:5.5,25:6}, 12.5:{6.25:1.5,12.5:2,25:3.5}, 18.75:{6.25:0.2,12.5:0.7,25:1.2}, 25:{6.25:0,12.5:0.2,25:0.3}, 37.25:{25:0.1}}
    },
    # Bảng UHF_625 (Source 116), UHF_125 (Source 123), UHF_25 (Source 130)
    "LAN_PROVINCE": {
        6.25: {0:{6.25:10,12.5:10,25:10}, 6.25:{6.25:2.1,12.5:6,25:8.7}, 12.5:{6.25:0.2,12.5:0.6,25:3.2}, 18.75:{6.25:0.3,12.5:0.2,25:0.8}},
        12.5: {0:{6.25:10,12.5:10,25:10}, 6.25:{6.25:6,12.5:7.2,25:8.7}, 12.5:{6.25:0.6,12.5:3,25:6}, 18.75:{6.25:0.2,12.5:0.2,25:1.2}, 25:{6.25:0,12.5:0.1,25:0.4}},
        25.0: {0:{6.25:10,12.5:10,25:10}, 6.25:{6.25:8.7,12.5:8.7,25:9}, 12.5:{6.25:3.2,12.5:6,25:6.5}, 18.75:{6.25:0.8,12.5:1.2,25:1.7}, 25:{6.25:0,12.5:0.4,25:0.4}, 37.25:{25:0.2}}
    },
    # Bảng UHF_625_WS (Source 139), UHF_125_WS (Source 146), UHF_25_WS (Source 153)
    "WAN_SIMPLEX": {
        6.25: {0:{6.25:120,12.5:120,25:120}, 6.25:{6.25:70,12.5:103,25:116}, 12.5:{6.25:8.1,12.5:19,25:86}, 18.75:{6.25:8.1,12.5:6.2,25:44}, 25:{6.25:6.4,12.5:5.1,25:5.2}},
        12.5: {0:{6.25:120,12.5:120,25:120}, 6.25:{6.25:110,12.5:110,25:115}, 12.5:{6.25:8.2,12.5:90,25:105}, 18.75:{6.25:7.5,12.5:5.4,25:56}, 25:{6.25:5.7,12.5:4,25:15}},
        25.0: {0:{6.25:120,12.5:120,25:120}, 6.25:{6.25:116,12.5:115,25:115}, 12.5:{6.25:86,12.5:105,25:105}, 18.75:{6.25:44,12.5:56,25:56}, 25:{6.25:5.2,12.5:15,25:15}}
    },
    # Bảng UHF_625_WD (Source 161), UHF_125_WD (Source 168), UHF_25_WD (Source 175)
    "WAN_DUPLEX": {
        6.25: {0:{6.25:100,12.5:100,25:100}, 6.25:{6.25:54,12.5:87,25:95}, 12.5:{6.25:0,12.5:0,25:65}},
        # Cập nhật chính xác bảng UHF_125_WD:
        12.5: {0:{6.25:100,12.5:120,25:120}, 6.25:{6.25:95,12.5:88,25:94}, 12.5:{6.25:0,12.5:57,25:105}, 18.75:{6.25:0,12.5:41,25:47}, 25:{6.25:0,12.5:4,25:15}},
        25.0: {0:{6.25:100,12.5:120,25:120}, 6.25:{6.25:95,12.5:94,25:94}, 12.5:{6.25:65,12.5:105,25:75}, 18.75:{6.25:0,12.5:47,25:49}, 25:{6.25:0,12.5:15,25:43}}
    }
}

MATRIX_CROSS = {
    "LAN_VS_WAN_SIMPLEX": {6.25:{0:{12.5:100},12.5:{12.5:20}}, 12.5:{0:{12.5:100},12.5:{12.5:20}}, 25.0:{0:{12.5:100},12.5:{12.5:20}}},
    "LAN_VS_WAN_DUPLEX": {6.25:{0:{12.5:120},12.5:{12.5:30}}, 12.5:{0:{12.5:120},12.5:{12.5:30}}, 25.0:{0:{12.5:120},12.5:{12.5:30}}},
    "WAN_SIMPLEX_VS_LAN": {6.25:{0:{12.5:120}}, 12.5:{0:{12.5:120}}, 25.0:{0:{12.5:120}}},
    "WAN_DUPLEX_VS_LAN": {6.25:{0:{12.5:140}}, 12.5:{0:{12.5:140}}, 25.0:{0:{12.5:140}}}
}